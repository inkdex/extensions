"use strict";var source=(()=>{var hi=Object.create;var ne=Object.defineProperty;var di=Object.getOwnPropertyDescriptor;var fi=Object.getOwnPropertyNames;var mi=Object.getPrototypeOf,gi=Object.prototype.hasOwnProperty;var yi=(r,e)=>()=>(r&&(e=r(r=0)),e);var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),wi=(r,e)=>{for(var t in e)ne(r,t,{get:e[t],enumerable:!0})},at=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of fi(e))!gi.call(r,n)&&n!==t&&ne(r,n,{get:()=>e[n],enumerable:!(i=di(e,n))||i.enumerable});return r};var Ce=(r,e,t)=>(t=r!=null?hi(mi(r)):{},at(e||!r||!r.__esModule?ne(t,"default",{value:r,enumerable:!0}):t,r)),_i=r=>at(ne({},"__esModule",{value:!0}),r);var lt=m(oe=>{"use strict";u();oe.byteLength=Ii;oe.toByteArray=Ci;oe.fromByteArray=bi;var U=[],A=[],Ei=typeof Uint8Array<"u"?Uint8Array:Array,Se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(G=0,ut=Se.length;G<ut;++G)U[G]=Se[G],A[Se.charCodeAt(G)]=G;var G,ut;A[45]=62;A[95]=63;function ct(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function Ii(r){var e=ct(r),t=e[0],i=e[1];return(t+i)*3/4-i}function xi(r,e,t){return(e+t)*3/4-t}function Ci(r){var e,t=ct(r),i=t[0],n=t[1],o=new Ei(xi(r,i,n)),s=0,c=n>0?i-4:i,l;for(l=0;l<c;l+=4)e=A[r.charCodeAt(l)]<<18|A[r.charCodeAt(l+1)]<<12|A[r.charCodeAt(l+2)]<<6|A[r.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return n===2&&(e=A[r.charCodeAt(l)]<<2|A[r.charCodeAt(l+1)]>>4,o[s++]=e&255),n===1&&(e=A[r.charCodeAt(l)]<<10|A[r.charCodeAt(l+1)]<<4|A[r.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function Si(r){return U[r>>18&63]+U[r>>12&63]+U[r>>6&63]+U[r&63]}function Ri(r,e,t){for(var i,n=[],o=e;o<t;o+=3)i=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),n.push(Si(i));return n.join("")}function bi(r){for(var e,t=r.length,i=t%3,n=[],o=16383,s=0,c=t-i;s<c;s+=o)n.push(Ri(r,s,s+o>c?c:s+o));return i===1?(e=r[t-1],n.push(U[e>>2]+U[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(U[e>>10]+U[e>>4&63]+U[e<<2&63]+"=")),n.join("")}});var pt=m(Re=>{u();Re.read=function(r,e,t,i,n){var o,s,c=n*8-i-1,l=(1<<c)-1,p=l>>1,f=-7,h=t?n-1:0,x=t?-1:1,E=r[e+h];for(h+=x,o=E&(1<<-f)-1,E>>=-f,f+=c;f>0;o=o*256+r[e+h],h+=x,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=i;f>0;s=s*256+r[e+h],h+=x,f-=8);if(o===0)o=1-p;else{if(o===l)return s?NaN:(E?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-p}return(E?-1:1)*s*Math.pow(2,o-i)};Re.write=function(r,e,t,i,n,o){var s,c,l,p=o*8-n-1,f=(1<<p)-1,h=f>>1,x=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=i?0:o-1,w=i?1:-1,B=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?e+=x/l:e+=x*Math.pow(2,1-h),e*l>=2&&(s++,l/=2),s+h>=f?(c=0,s=f):s+h>=1?(c=(e*l-1)*Math.pow(2,n),s=s+h):(c=e*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;r[t+E]=c&255,E+=w,c/=256,n-=8);for(s=s<<n|c,p+=n;p>0;r[t+E]=s&255,E+=w,s/=256,p-=8);r[t+E-w]|=B*128}});var At=m(K=>{"use strict";u();var be=lt(),Y=pt(),ht=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;K.Buffer=a;K.SlowBuffer=Mi;K.INSPECT_MAX_BYTES=50;var se=2147483647;K.kMaxLength=se;a.TYPED_ARRAY_SUPPORT=Bi();!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Bi(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}});Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function L(r){if(r>se)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,a.prototype),e}function a(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Pe(r)}return gt(r,e,t)}a.poolSize=8192;function gt(r,e,t){if(typeof r=="string")return Fi(r,e);if(ArrayBuffer.isView(r))return Pi(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(v(r,ArrayBuffer)||r&&v(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(v(r,SharedArrayBuffer)||r&&v(r.buffer,SharedArrayBuffer)))return Ae(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return a.from(i,e,t);let n=Ti(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return a.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}a.from=function(r,e,t){return gt(r,e,t)};Object.setPrototypeOf(a.prototype,Uint8Array.prototype);Object.setPrototypeOf(a,Uint8Array);function yt(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function Ai(r,e,t){return yt(r),r<=0?L(r):e!==void 0?typeof t=="string"?L(r).fill(e,t):L(r).fill(e):L(r)}a.alloc=function(r,e,t){return Ai(r,e,t)};function Pe(r){return yt(r),L(r<0?0:Te(r)|0)}a.allocUnsafe=function(r){return Pe(r)};a.allocUnsafeSlow=function(r){return Pe(r)};function Fi(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=wt(r,e)|0,i=L(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function Be(r){let e=r.length<0?0:Te(r.length)|0,t=L(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function Pi(r){if(v(r,Uint8Array)){let e=new Uint8Array(r);return Ae(e.buffer,e.byteOffset,e.byteLength)}return Be(r)}function Ae(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,a.prototype),i}function Ti(r){if(a.isBuffer(r)){let e=Te(r.length)|0,t=L(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Oe(r.length)?L(0):Be(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Be(r.data)}function Te(r){if(r>=se)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+se.toString(16)+" bytes");return r|0}function Mi(r){return+r!=r&&(r=0),a.alloc(+r)}a.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==a.prototype};a.compare=function(e,t){if(v(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),v(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let o=0,s=Math.min(i,n);o<s;++o)if(e[o]!==t[o]){i=e[o],n=t[o];break}return i<n?-1:n<i?1:0};a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return a.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=a.allocUnsafe(t),o=0;for(i=0;i<e.length;++i){let s=e[i];if(v(s,Uint8Array))o+s.length>n.length?(a.isBuffer(s)||(s=a.from(s)),s.copy(n,o)):Uint8Array.prototype.set.call(n,s,o);else if(a.isBuffer(s))s.copy(n,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return n};function wt(r,e){if(a.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||v(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Fe(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Bt(r).length;default:if(n)return i?-1:Fe(r).length;e=(""+e).toLowerCase(),n=!0}}a.byteLength=wt;function Oi(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Hi(this,e,t);case"utf8":case"utf-8":return Et(this,e,t);case"ascii":return ji(this,e,t);case"latin1":case"binary":return $i(this,e,t);case"base64":return qi(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gi(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}a.prototype._isBuffer=!0;function Q(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}a.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Q(this,t,t+1);return this};a.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Q(this,t,t+3),Q(this,t+1,t+2);return this};a.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Q(this,t,t+7),Q(this,t+1,t+6),Q(this,t+2,t+5),Q(this,t+3,t+4);return this};a.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Et(this,0,e):Oi.apply(this,arguments)};a.prototype.toLocaleString=a.prototype.toString;a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:a.compare(this,e)===0};a.prototype.inspect=function(){let e="",t=K.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};ht&&(a.prototype[ht]=a.prototype.inspect);a.prototype.compare=function(e,t,i,n,o){if(v(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),o===void 0&&(o=this.length),t<0||i>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=i)return 0;if(n>=o)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,o>>>=0,this===e)return 0;let s=o-n,c=i-t,l=Math.min(s,c),p=this.slice(n,o),f=e.slice(t,i);for(let h=0;h<l;++h)if(p[h]!==f[h]){s=p[h],c=f[h];break}return s<c?-1:c<s?1:0};function _t(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Oe(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=a.from(e,i)),a.isBuffer(e))return e.length===0?-1:dt(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):dt(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function dt(r,e,t,i,n){let o=1,s=r.length,c=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;o=2,s/=2,c/=2,t/=2}function l(f,h){return o===1?f[h]:f.readUInt16BE(h*o)}let p;if(n){let f=-1;for(p=t;p<s;p++)if(l(r,p)===l(e,f===-1?0:p-f)){if(f===-1&&(f=p),p-f+1===c)return f*o}else f!==-1&&(p-=p-f),f=-1}else for(t+c>s&&(t=s-c),p=t;p>=0;p--){let f=!0;for(let h=0;h<c;h++)if(l(r,p+h)!==l(e,h)){f=!1;break}if(f)return p}return-1}a.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};a.prototype.indexOf=function(e,t,i){return _t(this,e,t,i,!0)};a.prototype.lastIndexOf=function(e,t,i){return _t(this,e,t,i,!1)};function Ui(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let o=e.length;i>o/2&&(i=o/2);let s;for(s=0;s<i;++s){let c=parseInt(e.substr(s*2,2),16);if(Oe(c))return s;r[t+s]=c}return s}function vi(r,e,t,i){return ae(Fe(e,r.length-t),r,t,i)}function Di(r,e,t,i){return ae(Yi(e),r,t,i)}function Li(r,e,t,i){return ae(Bt(e),r,t,i)}function ki(r,e,t,i){return ae(zi(e,r.length-t),r,t,i)}a.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-t;if((i===void 0||i>o)&&(i=o),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return Ui(this,e,t,i);case"utf8":case"utf-8":return vi(this,e,t,i);case"ascii":case"latin1":case"binary":return Di(this,e,t,i);case"base64":return Li(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ki(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function qi(r,e,t){return e===0&&t===r.length?be.fromByteArray(r):be.fromByteArray(r.slice(e,t))}function Et(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let o=r[n],s=null,c=o>239?4:o>223?3:o>191?2:1;if(n+c<=t){let l,p,f,h;switch(c){case 1:o<128&&(s=o);break;case 2:l=r[n+1],(l&192)===128&&(h=(o&31)<<6|l&63,h>127&&(s=h));break;case 3:l=r[n+1],p=r[n+2],(l&192)===128&&(p&192)===128&&(h=(o&15)<<12|(l&63)<<6|p&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:l=r[n+1],p=r[n+2],f=r[n+3],(l&192)===128&&(p&192)===128&&(f&192)===128&&(h=(o&15)<<18|(l&63)<<12|(p&63)<<6|f&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,c=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),n+=c}return Ni(i)}var ft=4096;function Ni(r){let e=r.length;if(e<=ft)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=ft));return t}function ji(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function $i(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function Hi(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let o=e;o<t;++o)n+=Ki[r[o]];return n}function Gi(r,e,t){let i=r.slice(e,t),n="";for(let o=0;o<i.length-1;o+=2)n+=String.fromCharCode(i[o]+i[o+1]*256);return n}a.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n};function I(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||I(e,t,this.length);let n=this[e],o=1,s=0;for(;++s<t&&(o*=256);)n+=this[e+s]*o;return n};a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||I(e,t,this.length);let n=this[e+--t],o=1;for(;t>0&&(o*=256);)n+=this[e+--t]*o;return n};a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e=e>>>0,t||I(e,1,this.length),this[e]};a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||I(e,2,this.length),this[e]|this[e+1]<<8};a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||I(e,2,this.length),this[e]<<8|this[e+1]};a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||I(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};a.prototype.readBigUInt64LE=j(function(e){e=e>>>0,z(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&ee(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))});a.prototype.readBigUInt64BE=j(function(e){e=e>>>0,z(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&ee(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(o)});a.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||I(e,t,this.length);let n=this[e],o=1,s=0;for(;++s<t&&(o*=256);)n+=this[e+s]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n};a.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||I(e,t,this.length);let n=t,o=1,s=this[e+--n];for(;n>0&&(o*=256);)s+=this[e+--n]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s};a.prototype.readInt8=function(e,t){return e=e>>>0,t||I(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};a.prototype.readInt16LE=function(e,t){e=e>>>0,t||I(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};a.prototype.readInt16BE=function(e,t){e=e>>>0,t||I(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};a.prototype.readInt32LE=function(e,t){return e=e>>>0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};a.prototype.readInt32BE=function(e,t){return e=e>>>0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};a.prototype.readBigInt64LE=j(function(e){e=e>>>0,z(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&ee(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});a.prototype.readBigInt64BE=j(function(e){e=e>>>0,z(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&ee(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});a.prototype.readFloatLE=function(e,t){return e=e>>>0,t||I(e,4,this.length),Y.read(this,e,!0,23,4)};a.prototype.readFloatBE=function(e,t){return e=e>>>0,t||I(e,4,this.length),Y.read(this,e,!1,23,4)};a.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||I(e,8,this.length),Y.read(this,e,!0,52,8)};a.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||I(e,8,this.length),Y.read(this,e,!1,52,8)};function S(r,e,t,i,n,o){if(!a.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let c=Math.pow(2,8*i)-1;S(this,e,t,i,c,0)}let o=1,s=0;for(this[t]=e&255;++s<i&&(o*=256);)this[t+s]=e/o&255;return t+i};a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let c=Math.pow(2,8*i)-1;S(this,e,t,i,c,0)}let o=i-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+i};a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,1,255,0),this[t]=e&255,t+1};a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function It(r,e,t,i,n){bt(e,i,n,r,t,7);let o=Number(e&BigInt(4294967295));r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,t}function xt(r,e,t,i,n){bt(e,i,n,r,t,7);let o=Number(e&BigInt(4294967295));r[t+7]=o,o=o>>8,r[t+6]=o,o=o>>8,r[t+5]=o,o=o>>8,r[t+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=s,s=s>>8,r[t+2]=s,s=s>>8,r[t+1]=s,s=s>>8,r[t]=s,t+8}a.prototype.writeBigUInt64LE=j(function(e,t=0){return It(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});a.prototype.writeBigUInt64BE=j(function(e,t=0){return xt(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});a.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let l=Math.pow(2,8*i-1);S(this,e,t,i,l-1,-l)}let o=0,s=1,c=0;for(this[t]=e&255;++o<i&&(s*=256);)e<0&&c===0&&this[t+o-1]!==0&&(c=1),this[t+o]=(e/s>>0)-c&255;return t+i};a.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let l=Math.pow(2,8*i-1);S(this,e,t,i,l-1,-l)}let o=i-1,s=1,c=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&c===0&&this[t+o+1]!==0&&(c=1),this[t+o]=(e/s>>0)-c&255;return t+i};a.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};a.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};a.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};a.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};a.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||S(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};a.prototype.writeBigInt64LE=j(function(e,t=0){return It(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});a.prototype.writeBigInt64BE=j(function(e,t=0){return xt(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ct(r,e,t,i,n,o){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function St(r,e,t,i,n){return e=+e,t=t>>>0,n||Ct(r,e,t,4,34028234663852886e22,-34028234663852886e22),Y.write(r,e,t,i,23,4),t+4}a.prototype.writeFloatLE=function(e,t,i){return St(this,e,t,!0,i)};a.prototype.writeFloatBE=function(e,t,i){return St(this,e,t,!1,i)};function Rt(r,e,t,i,n){return e=+e,t=t>>>0,n||Ct(r,e,t,8,17976931348623157e292,-17976931348623157e292),Y.write(r,e,t,i,52,8),t+8}a.prototype.writeDoubleLE=function(e,t,i){return Rt(this,e,t,!0,i)};a.prototype.writeDoubleBE=function(e,t,i){return Rt(this,e,t,!1,i)};a.prototype.copy=function(e,t,i,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let o=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),o};a.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let s=e.charCodeAt(0);(n==="utf8"&&s<128||n==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let o;if(typeof e=="number")for(o=t;o<i;++o)this[o]=e;else{let s=a.isBuffer(e)?e:a.from(e,n),c=s.length;if(c===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<i-t;++o)this[o+t]=s[o%c]}return this};var W={};function Me(r,e,t){W[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Me("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Me("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);Me("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=mt(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=mt(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function mt(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Qi(r,e,t){z(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&ee(e,r.length-(t+1))}function bt(r,e,t,i,n,o){if(r>t||r<e){let s=typeof e=="bigint"?"n":"",c;throw o>3?e===0||e===BigInt(0)?c=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:c=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:c=`>= ${e}${s} and <= ${t}${s}`,new W.ERR_OUT_OF_RANGE("value",c,r)}Qi(i,n,o)}function z(r,e){if(typeof r!="number")throw new W.ERR_INVALID_ARG_TYPE(e,"number",r)}function ee(r,e,t){throw Math.floor(r)!==r?(z(r,t),new W.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new W.ERR_BUFFER_OUT_OF_BOUNDS:new W.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var Vi=/[^+/0-9A-Za-z-_]/g;function Wi(r){if(r=r.split("=")[0],r=r.trim().replace(Vi,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Fe(r,e){e=e||1/0;let t,i=r.length,n=null,o=[];for(let s=0;s<i;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Yi(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function zi(r,e){let t,i,n,o=[];for(let s=0;s<r.length&&!((e-=2)<0);++s)t=r.charCodeAt(s),i=t>>8,n=t%256,o.push(n),o.push(i);return o}function Bt(r){return be.toByteArray(Wi(r))}function ae(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function v(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Oe(r){return r!==r}var Ki=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function j(r){return typeof BigInt>"u"?Ji:r}function Ji(){throw new Error("BigInt not supported")}});var d,u=yi(()=>{d=At().Buffer});var Ft=m(ue=>{"use strict";u();Object.defineProperty(ue,"__esModule",{value:!0});ue.Form=void 0;var Ue=class{reloadForm(){let e=this.__underlying_formId;e&&Application.formDidChange(e)}get requiresExplicitSubmission(){return!1}};ue.Form=Ue});var Pt=m(F=>{"use strict";u();Object.defineProperty(F,"__esModule",{value:!0});F.LabelRow=Xi;F.InputRow=Zi;F.StepperRow=en;F.ToggleRow=tn;F.SelectRow=rn;F.ButtonRow=nn;F.WebViewRow=on;F.NavigationRow=sn;F.OAuthButtonRow=an;F.DeferredItem=un;function Xi(r,e){return{...e,id:r,type:"labelRow",isHidden:e.isHidden??!1}}function Zi(r,e){return{...e,id:r,type:"inputRow",isHidden:e.isHidden??!1}}function en(r,e){return{...e,id:r,type:"stepperRow",isHidden:e.isHidden??!1}}function tn(r,e){return{...e,id:r,type:"toggleRow",isHidden:e.isHidden??!1}}function rn(r,e){return{...e,id:r,type:"selectRow",isHidden:e.isHidden??!1}}function nn(r,e){return{...e,id:r,type:"buttonRow",isHidden:e.isHidden??!1}}function on(r,e){return{...e,id:r,type:"webViewRow",isHidden:e.isHidden??!1}}function sn(r,e){return{...e,id:r,type:"navigationRow",isHidden:e.isHidden??!1}}function an(r,e){return{...e,id:r,type:"oauthButtonRow",isHidden:e.isHidden??!1}}function un(r){return r()}});var Tt=m(ve=>{"use strict";u();Object.defineProperty(ve,"__esModule",{value:!0});ve.Section=cn;function cn(r,e){let t;return typeof r=="string"?t={id:r}:t=r,{...t,items:e.filter(i=>i)}}});var Mt=m(k=>{"use strict";u();var ln=k&&k.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),De=k&&k.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ln(e,r,t)};Object.defineProperty(k,"__esModule",{value:!0});De(Ft(),k);De(Pt(),k);De(Tt(),k)});var Ut=m(Ot=>{"use strict";u();Object.defineProperty(Ot,"__esModule",{value:!0})});var Dt=m(vt=>{"use strict";u();Object.defineProperty(vt,"__esModule",{value:!0})});var kt=m(Lt=>{"use strict";u();Object.defineProperty(Lt,"__esModule",{value:!0})});var Nt=m(qt=>{"use strict";u();Object.defineProperty(qt,"__esModule",{value:!0})});var $t=m(jt=>{"use strict";u();Object.defineProperty(jt,"__esModule",{value:!0})});var Gt=m(Ht=>{"use strict";u();Object.defineProperty(Ht,"__esModule",{value:!0})});var Vt=m(Qt=>{"use strict";u();Object.defineProperty(Qt,"__esModule",{value:!0})});var Yt=m(Wt=>{"use strict";u();Object.defineProperty(Wt,"__esModule",{value:!0})});var zt=m(R=>{"use strict";u();var pn=R&&R.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),$=R&&R.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pn(e,r,t)};Object.defineProperty(R,"__esModule",{value:!0});$(Ut(),R);$(Dt(),R);$(kt(),R);$(Nt(),R);$($t(),R);$(Gt(),R);$(Vt(),R);$(Yt(),R)});var Jt=m(Kt=>{"use strict";u();Object.defineProperty(Kt,"__esModule",{value:!0})});var le=m(ce=>{"use strict";u();Object.defineProperty(ce,"__esModule",{value:!0});ce.PaperbackInterceptor=void 0;var Le=class{id;constructor(e){this.id=e}registerInterceptor(){Application.registerInterceptor(this.id,Application.Selector(this,"interceptRequest"),Application.Selector(this,"interceptResponse"))}unregisterInterceptor(){Application.unregisterInterceptor(this.id)}};ce.PaperbackInterceptor=Le});var Zt=m(Xt=>{"use strict";u();Object.defineProperty(Xt,"__esModule",{value:!0})});var tr=m(er=>{"use strict";u();Object.defineProperty(er,"__esModule",{value:!0})});var rr=m(V=>{"use strict";u();Object.defineProperty(V,"__esModule",{value:!0});V.unlock=V.lock=void 0;var pe={},ke={},hn=async r=>{if(pe[r]){await pe[r],await(0,V.lock)(r);return}pe[r]=new Promise(e=>ke[r]=()=>{delete pe[r],e()})};V.lock=hn;var dn=r=>{ke[r]&&ke[r]()};V.unlock=dn});var nr=m(he=>{"use strict";u();Object.defineProperty(he,"__esModule",{value:!0});he.BasicRateLimiter=void 0;var ir=rr(),fn=le(),qe=class extends fn.PaperbackInterceptor{options;promise;currentRequestsMade=0;lastReset=Date.now();imageRegex=new RegExp(/\.(png|gif|jpeg|jpg|webp)(\?|$)/i);constructor(e,t){super(e),this.options=t}async interceptRequest(e){return this.options.ignoreImages&&this.imageRegex.test(e.url)||(await(0,ir.lock)(this.id),await this.incrementRequestCount(),(0,ir.unlock)(this.id)),e}async interceptResponse(e,t,i){return i}async incrementRequestCount(){if(await this.promise,(Date.now()-this.lastReset)/1e3>this.options.bufferInterval&&(this.currentRequestsMade=0,this.lastReset=Date.now()),this.currentRequestsMade+=1,this.currentRequestsMade>=this.options.numberOfRequests){let t=(Date.now()-this.lastReset)/1e3;if(t<=this.options.bufferInterval){let i=this.options.bufferInterval-t;console.log(`[BasicRateLimiter] rate limit hit, sleeping for ${i}`),this.promise=Application.sleep(i)}}}};he.BasicRateLimiter=qe});var or=m(de=>{"use strict";u();Object.defineProperty(de,"__esModule",{value:!0});de.CloudflareError=void 0;var Ne=class extends Error{resolutionRequest;type="cloudflareError";constructor(e,t="Cloudflare bypass is required"){super(t),this.resolutionRequest=e}};de.CloudflareError=Ne});var He=m(te=>{"use strict";u();Object.defineProperty(te,"__esModule",{value:!0});te.URL=void 0;te.parseURL=je;function je(r){let e={},t=/^(?:([a-zA-Z][a-zA-Z\d+\-.]*):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,i=r.match(t);if(!i)throw new Error("Invalid URL string provided.");if(i[1]!==void 0&&i[1]!==""&&(e.protocol=i[1]),i[2]!==void 0&&i[2]!==""){let n=i[2],o="",s="",c=n.indexOf("@");if(c!==-1){if(o=n.substring(0,c),s=n.substring(c+1),o!==""){let l=o.indexOf(":");l!==-1?(e.username=o.substring(0,l),e.password=o.substring(l+1)):(e.username=o,e.password="")}}else s=n;if(s!=="")if(s.startsWith("[")){let l=s.indexOf("]");if(l===-1)throw new Error("Invalid IPv6 address in URL update.");e.hostname=s.substring(0,l+1);let p=s.substring(l+1);p.startsWith(":")&&(e.port=p.substring(1))}else{let l=s.lastIndexOf(":");l!==-1&&s.indexOf(":")===l?(e.hostname=s.substring(0,l),e.port=s.substring(l+1)):(e.hostname=s,e.port="")}}if(i[3]!==void 0&&i[3]!==""&&(e.path=i[3].startsWith("/")?i[3]:`/${i[3]}`),i[4]!==void 0){let n={},o=i[4].split("&");for(let s of o){if(!s)continue;let[c,l=""]=s.split("="),p=decodeURIComponent(c),f=decodeURIComponent(l);if(p in n){let h=n[p];Array.isArray(h)?h.push(f):n[p]=[h,f]}else n[p]=f}e.queryItems=n}return i[5]!==void 0&&(e.fragment=i[5]),e}var $e=class{protocol;hostname;path;username;password;port;queryItems={};fragment;constructor(e){let t=je(e);if(!t.hostname||!t.protocol)throw new Error("URL Hostname and Protocol are required");this.hostname=t.hostname,this.protocol=t.protocol,this.path=t.path??"",this.username=t.username,this.password=t.password,this.port=t.port,this.queryItems=t.queryItems,this.fragment=t.fragment}toString(){let e=`${this.protocol}://`;if(this.username!==void 0&&this.username!==""&&(e+=this.username,this.password!==void 0&&this.password!==""&&(e+=`:${this.password}`),e+="@"),e+=this.hostname,this.port!==void 0&&this.port!==""&&(e+=`:${this.port}`),this.path!==""&&(e+=this.path.startsWith("/")?this.path:`/${this.path}`),this.queryItems!==void 0){let t=Object.keys(this.queryItems),i=[];if(t.length>0)for(let n of t){let o=this.queryItems[n];if(Array.isArray(o))for(let s of o)i.push(`${encodeURIComponent(n)}=${encodeURIComponent(s)}`);else i.push(`${encodeURIComponent(n)}=${encodeURIComponent(o)}`)}e+=`?${i.join("&")}`}return this.fragment!==void 0&&(e+=`#${this.fragment}`),e}setProtocol(e){if(e==="")throw new Error("Protocol is required");return this.protocol=e,this}setUsername(e){return e===""?this.username=void 0:this.username=e,this}setPassword(e){return e===""?this.password=void 0:this.password=e,this}setHostname(e){if(e==="")throw new Error("Hostname is required");return this.hostname=e,this}setPort(e){return e===""?this.port=void 0:this.port=e,this}setPath(e){return this.path=e.startsWith("/")?e:`/${e}`,this}addPathComponent(e){return this.path=(this.path??"")+(e.startsWith("/")?e:`/${e}`),this}setQueryItems(e){return this.queryItems=e,this}setQueryItem(e,t){return this.queryItems===void 0&&(this.queryItems={}),this.queryItems[e]=t,this}removeQueryItem(e){return delete this.queryItems?.[e],this}setFragment(e){return this.fragment=e,this}update(e){let t;return typeof e=="string"?t=je(e):t=e,t.protocol!==void 0&&this.setProtocol(t.protocol),t.username!==void 0&&this.setUsername(t.username),t.password!==void 0&&this.setPassword(t.password),t.hostname!==void 0&&this.setHostname(t.hostname),t.port!==void 0&&this.setPort(t.port),t.path!==void 0&&this.setPath(t.path),t.queryItems!==void 0&&this.setQueryItems(t.queryItems),t.fragment!==void 0&&this.setFragment(t.fragment),this}};te.URL=$e});var ar=m(fe=>{"use strict";u();Object.defineProperty(fe,"__esModule",{value:!0});fe.CookieStorageInterceptor=void 0;var mn=le(),gn=He(),sr="cookie_store_cookies",Ge=class extends mn.PaperbackInterceptor{options;_cookies={};get cookies(){return Object.freeze(Object.values(this._cookies))}set cookies(e){let t={};for(let i of e)this.isCookieExpired(i)||(t[this.cookieIdentifier(i)]=i);this._cookies=t,this.saveCookiesToStorage()}constructor(e){super("cookie_store"),this.options=e,this.loadCookiesFromStorage()}async interceptRequest(e){return e.cookies={...e.cookies??{},...this.cookiesForUrl(e.url).reduce((t,i)=>(t[i.name]=i.value,t),{})},e}async interceptResponse(e,t,i){let n=this._cookies;for(let o of t.cookies){let s=this.cookieIdentifier(o);if(this.isCookieExpired(o)){delete n[s];continue}n[s]=o}return this._cookies=n,this.saveCookiesToStorage(),i}setCookie(e){this.isCookieExpired(e)||(this._cookies[this.cookieIdentifier(e)]=e,this.saveCookiesToStorage())}deleteCookie(e){delete this._cookies[this.cookieIdentifier(e)]}cookiesForUrl(e){console.log("[COMPAT] COOKIES FOR URL");let t=new gn.URL(e),i=t.hostname;if(!i)return[];let n={},o=t.path.startsWith("/")?t.path:`/${t.path}`,s=i.split("."),c=o.split("/");c.shift();let l=this.cookies;for(let p of l){if(this.isCookieExpired(p)){delete this._cookies[this.cookieIdentifier(p)];continue}let h=this.cookieSanitizedDomain(p).split(".");if(s.length<h.length||h.length==0)continue;let x=!0;for(let b=0;b<h.length;b++){let Z=h.length-1-b,xe=s.length-1-b;if(h[Z]!=s[xe]){x=!1;break}}if(!x)continue;let E=this.cookieSanitizedPath(p),w=E.split("/");w.shift();let B=0;if(o===E)B=Number.MAX_SAFE_INTEGER;else if(w.length===0||E==="/")B=1;else if(o.startsWith(E)&&c.length>=w.length)for(let b=0;b<w.length&&w[b]===c[b];b++)B+=1;B<=0||(n[p.name]?.pathMatches??0)<B&&(n[p.name]={cookie:p,pathMatches:B})}return Object.values(n).map(p=>p.cookie)}cookieIdentifier(e){return`${e.name}-${this.cookieSanitizedDomain(e)}-${this.cookieSanitizedPath(e)}`}cookieSanitizedPath(e){return e.path?.startsWith("/")?e.path:"/"+(e.path??"")}cookieSanitizedDomain(e){return e.domain.replace(/^(www)?\.?/gi,"").toLowerCase()}isCookieExpired(e){return!!(e.expires&&e.expires.getTime()<=Date.now())}loadCookiesFromStorage(){if(this.options.storage=="memory")return;let e=Application.getState(sr);if(!e){this._cookies={};return}let t={};for(let i of e)!i.expires||this.isCookieExpired(i)||(t[this.cookieIdentifier(i)]=i);this._cookies=t}saveCookiesToStorage(){this.options.storage!="memory"&&Application.setState(this.cookies.filter(e=>e.expires),sr)}};fe.CookieStorageInterceptor=Ge});var ur=m(Ve=>{"use strict";u();Object.defineProperty(Ve,"__esModule",{value:!0});Ve.createFormState=yn;var Qe=class{form;_value;_selector;constructor(e,t){this.form=e,this._value=t,this._selector=Application.Selector(this,"updateValue")}get value(){return this._value}get selector(){return this._selector}async updateValue(e){this._value=e,this.form.reloadForm()}};function yn(r,e){let t=new Qe(r,e);return[()=>t.value,t.updateValue.bind(t),t.selector]}});var cr=m(C=>{"use strict";u();var wn=C&&C.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),T=C&&C.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&wn(e,r,t)};Object.defineProperty(C,"__esModule",{value:!0});T(Mt(),C);T(zt(),C);T(Jt(),C);T(le(),C);T(Zt(),C);T(tr(),C);T(nr(),C);T(or(),C);T(ar(),C);T(ur(),C);T(He(),C)});var pr=m(lr=>{"use strict";u();Object.defineProperty(lr,"__esModule",{value:!0})});var dr=m(hr=>{"use strict";u();Object.defineProperty(hr,"__esModule",{value:!0})});var mr=m(fr=>{"use strict";u();Object.defineProperty(fr,"__esModule",{value:!0})});var yr=m(gr=>{"use strict";u();Object.defineProperty(gr,"__esModule",{value:!0})});var _r=m(me=>{"use strict";u();Object.defineProperty(me,"__esModule",{value:!0});me.DiscoverSectionType=void 0;var wr;(function(r){r[r.featured=0]="featured",r[r.simpleCarousel=1]="simpleCarousel",r[r.prominentCarousel=2]="prominentCarousel",r[r.chapterUpdates=3]="chapterUpdates",r[r.genres=4]="genres"})(wr||(me.DiscoverSectionType=wr={}))});var Ir=m(Er=>{"use strict";u();Object.defineProperty(Er,"__esModule",{value:!0})});var Cr=m(xr=>{"use strict";u();Object.defineProperty(xr,"__esModule",{value:!0})});var Rr=m(Sr=>{"use strict";u();Object.defineProperty(Sr,"__esModule",{value:!0})});var br=m(ge=>{"use strict";u();Object.defineProperty(ge,"__esModule",{value:!0});ge.EndOfPageResults=void 0;ge.EndOfPageResults=Object.freeze({items:[],metadata:void 0})});var Ar=m(Br=>{"use strict";u();Object.defineProperty(Br,"__esModule",{value:!0})});var Pr=m(Fr=>{"use strict";u();Object.defineProperty(Fr,"__esModule",{value:!0})});var Mr=m(Tr=>{"use strict";u();Object.defineProperty(Tr,"__esModule",{value:!0})});var Ur=m(Or=>{"use strict";u();Object.defineProperty(Or,"__esModule",{value:!0})});var Dr=m(vr=>{"use strict";u();Object.defineProperty(vr,"__esModule",{value:!0})});var kr=m(Lr=>{"use strict";u();Object.defineProperty(Lr,"__esModule",{value:!0})});var Nr=m(qr=>{"use strict";u();Object.defineProperty(qr,"__esModule",{value:!0})});var Hr=m(J=>{"use strict";u();Object.defineProperty(J,"__esModule",{value:!0});J.ContentRating=J.SourceIntents=void 0;var jr;(function(r){r[r.MANGA_CHAPTERS=1]="MANGA_CHAPTERS",r[r.MANGA_TRACKING=2]="MANGA_TRACKING",r[r.MANGA_PROGRESS=2]="MANGA_PROGRESS",r[r.HOMEPAGE_SECTIONS=4]="HOMEPAGE_SECTIONS",r[r.DISCOVER_SECIONS=4]="DISCOVER_SECIONS",r[r.COLLECTION_MANAGEMENT=8]="COLLECTION_MANAGEMENT",r[r.CLOUDFLARE_BYPASS_REQUIRED=16]="CLOUDFLARE_BYPASS_REQUIRED",r[r.SETTINGS_UI=32]="SETTINGS_UI",r[r.MANGA_SEARCH=64]="MANGA_SEARCH"})(jr||(J.SourceIntents=jr={}));var $r;(function(r){r.EVERYONE="SAFE",r.MATURE="MATURE",r.ADULT="ADULT"})($r||(J.ContentRating=$r={}))});var Qr=m(Gr=>{"use strict";u();Object.defineProperty(Gr,"__esModule",{value:!0})});var Wr=m(Vr=>{"use strict";u();Object.defineProperty(Vr,"__esModule",{value:!0})});var zr=m(Yr=>{"use strict";u();Object.defineProperty(Yr,"__esModule",{value:!0})});var Jr=m(Kr=>{"use strict";u();Object.defineProperty(Kr,"__esModule",{value:!0})});var Zr=m(Xr=>{"use strict";u();Object.defineProperty(Xr,"__esModule",{value:!0})});var re=m(g=>{"use strict";u();var _n=g&&g.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,i,n)}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),y=g&&g.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&_n(e,r,t)};Object.defineProperty(g,"__esModule",{value:!0});y(cr(),g);y(pr(),g);y(dr(),g);y(mr(),g);y(yr(),g);y(_r(),g);y(Ir(),g);y(re(),g);y(Cr(),g);y(Rr(),g);y(br(),g);y(Ar(),g);y(Pr(),g);y(Mr(),g);y(Ur(),g);y(Dr(),g);y(kr(),g);y(Nr(),g);y(Hr(),g);y(Qr(),g);y(Wr(),g);y(zr(),g);y(Jr(),g);y(Zr(),g)});var An={};wi(An,{ComicK:()=>Bn,ComicKExtension:()=>Ie});u();var P=Ce(re(),1);u();u();var ye=class{baseUrl;queryParams={};pathSegments=[];constructor(e){this.baseUrl=e.replace(/\/+$/,"")}formatArrayQuery(e,t){return t.length>0?t.map(i=>`${e}[]=${i}`):[]}formatObjectQuery(e,t){return Object.entries(t).map(([i,n])=>n!==void 0?`${e}[${i}]=${n}`:void 0).filter(i=>i!==void 0)}formatQuery(e){return Object.entries(e).flatMap(([t,i])=>Array.isArray(i)?this.formatArrayQuery(t,i):typeof i=="object"?this.formatObjectQuery(t,i):i===""?[]:[`${t}=${i}`]).join("&")}build(){let e=this.pathSegments.length>0?`/${this.pathSegments.join("/")}`:"",t=this.formatQuery(this.queryParams);return t.length>0?`${this.baseUrl}${e}?${t}`:`${this.baseUrl}${e}`}addPath(e){return this.pathSegments.push(e.replace(/^\/+|\/+$/g,"")),this}addQuery(e,t){return this.queryParams[e]=t,this}reset(){return this.queryParams={},this.pathSegments=[],this}};var M=class extends ye{formatArrayQuery(e,t){return t.length>0?t.map(i=>`${e}=${i}`):[]}};u();var _=Ce(re(),1);u();function q(r,e){return Application.getState(r)??e}u();var ei=[{code:"all",name:"All Languages"},{code:"en",name:"English"},{code:"pt-br",name:"Portugu\xEAs do Brasil"},{code:"es-419",name:"Espa\xF1ol (Latinoam\xE9rica)"},{code:"ru",name:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},{code:"fr",name:"Fran\xE7ais"},{code:"pl",name:"Polski"},{code:"vi",name:"Ti\u1EBFng Vi\u1EC7t"},{code:"tr",name:"T\xFCrk\xE7e"},{code:"id",name:"Bahasa Indonesia"},{code:"it",name:"Italiano"},{code:"es",name:"Espa\xF1ol"},{code:"ar",name:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},{code:"zh-hk",name:"\u7E41\u9AD4\u4E2D\u6587 (\u9999\u6E2F)"},{code:"uk",name:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},{code:"hu",name:"Magyar"},{code:"de",name:"Deutsch"},{code:"zh",name:"\u4E2D\u6587"},{code:"ko",name:"\uD55C\uAD6D\uC5B4"},{code:"th",name:"\u0E44\u0E17\u0E22"},{code:"bg",name:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438"},{code:"ca",name:"Catal\xE0"},{code:"fa",name:"\u0641\u0627\u0631\u0633\u06CC"},{code:"ro",name:"Rom\xE2n\u0103"},{code:"cs",name:"\u010Ce\u0161tina"},{code:"mn",name:"\u041C\u043E\u043D\u0433\u043E\u043B"},{code:"pt",name:"Portugu\xEAs"},{code:"he",name:"\u05E2\u05D1\u05E8\u05D9\u05EA"},{code:"hi",name:"\u0939\u093F\u0928\u094D\u0926\u0940"},{code:"tl",name:"Tagalog"},{code:"ms",name:"Bahasa Melayu"},{code:"eu",name:"Euskara"},{code:"kk",name:"\u049A\u0430\u0437\u0430\u049B"},{code:"sr",name:"\u0421\u0440\u043F\u0441\u043A\u0438"},{code:"my",name:"\u1019\u103C\u1014\u103A\u1019\u102C\u1005\u102C"},{code:"el",name:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC"},{code:"nl",name:"Nederlands"},{code:"ja",name:"\u65E5\u672C\u8A9E"},{code:"eo",name:"Esperanto"},{code:"fi",name:"Suomi"},{code:"ka",name:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8"},{code:"lt",name:"Lietuvi\u0173"},{code:"ta",name:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD"},{code:"bn",name:"\u09AC\u09BE\u0982\u09B2\u09BE"},{code:"sv",name:"Svenska"},{code:"hr",name:"Hrvatski"},{code:"la",name:"Latina"},{code:"ne",name:"\u0928\u0947\u092A\u093E\u0932\u0940"},{code:"cv",name:"\u0427\u04D1\u0432\u0430\u0448"},{code:"ur",name:"\u0627\u0631\u062F\u0648"},{code:"be",name:"\u0411\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F"},{code:"no",name:"Norsk"},{code:"sq",name:"Shqip"},{code:"te",name:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},{code:"da",name:"Dansk"},{code:"et",name:"Eesti"},{code:"ga",name:"Gaeilge"},{code:"az",name:"Az\u0259rbaycan"},{code:"sk",name:"Sloven\u010Dina"},{code:"jv",name:"Basa Jawa"},{code:"af",name:"Afrikaans"},{code:"sl",name:"Sloven\u0161\u010Dina"},{code:"uz",name:"\u040E\u0437\u0431\u0435\u043A"}];function ti(){return ei.map(r=>({id:r.code,title:r.name}))}function ri(r){return ei.find(e=>e.code==r)?.name??"Unknown"}function we(){return q("languages",["all"])}function En(){return q("language_home_filter",!1)}function Ye(){return q("show_title",!1)}function ze(){return q("show_volume_number",!1)}function Ke(){return q("chapter_score_filtering",!1)}function Je(){return q("hide_unreleased_chapters",!0)}function Xe(){return q("show_tags",!1)}function Ze(){return q("cloudflare_rate_limit_backoff",!1)}var _e=class extends _.Form{getSections(){let e=we(),t=En(),i=Xe();return[(0,_.Section)({id:"languageContent",footer:"Filter Home and Search page titles by language."},[(0,_.SelectRow)("languages",{title:"Languages",options:ti(),value:e,minItemCount:1,maxItemCount:45,onValueChange:Application.Selector(this,"onSetLanguage")}),(0,_.ToggleRow)("language_home_filter",{title:"Filter Homepage Language",value:t,onValueChange:Application.Selector(this,"onLanguageHomeFilter")})]),(0,_.Section)({id:"includeTags",footer:"Show tags in manga details after genres."},[(0,_.ToggleRow)("show_tags",{title:"Show Tags",value:i,onValueChange:Application.Selector(this,"onShowTags")})]),(0,_.Section)({id:"chapterForm",footer:"Manage chapter specific settings."},[(0,_.NavigationRow)("chapterForm",{title:"Chapter Settings",form:new We})]),(0,_.Section)({id:"rateLimit",footer:"Automatically retries requests when Cloudflare rate limits occur."},[(0,_.ToggleRow)("cloudflare_rate_limit_backoff_switch",{title:"Retry on Cloudflare Rate Limit",value:Ze(),onValueChange:Application.Selector(this,"onCloudflareRateLimitBackoff")})])]}async onSetLanguage(e){let t=we();if(e.filter(o=>!t.includes(o)).includes("all")){Application.setState(["all"],"languages");return}let n=e;t.includes("all")&&e.length>1&&(n=e.filter(o=>o!=="all")),Application.setState(n,"languages")}async onLanguageHomeFilter(e){Application.setState(e,"language_home_filter")}async onShowTags(e){Application.setState(e,"show_tags")}async onCloudflareRateLimitBackoff(e){Application.setState(e,"cloudflare_rate_limit_backoff")}},We=class extends _.Form{getSections(){let e=Je(),t=ze(),i=Ye(),n=Ke();return[(0,_.Section)({id:"chapterUnreleased",footer:"Hide chapters that are not yet released."},[(0,_.ToggleRow)("hide_unreleased_chapters",{title:"Hide Unreleased Chapters",value:e,onValueChange:Application.Selector(this,"onHideUnreleasedChapters")})]),(0,_.Section)({id:"chapter_score_filtering",footer:n?"Show only the uploader with the most upvotes for each chapter. Disable to manually manage uploader filtering":"Show only the uploader with the most upvotes for each chapter."},[(0,_.ToggleRow)("toggle_chapter_score_filtering",{title:"Enable Chapter Score Filtering",value:n,onValueChange:Application.Selector(this,"onChapterScoreFiltering")})]),(0,_.Section)({id:"chapterContent",footer:"Chapter list formatting."},[(0,_.ToggleRow)("show_volume_number",{title:"Show Chapter Volume",value:t,onValueChange:Application.Selector(this,"onShowVolumeNumber")}),(0,_.ToggleRow)("show_title",{title:"Show Chapter Title",value:i,onValueChange:Application.Selector(this,"onShowTitle")})])]}async onHideUnreleasedChapters(e){Application.setState(e,"hide_unreleased_chapters")}async onChapterScoreFiltering(e){Application.setState(e,"chapter_score_filtering")}async onShowVolumeNumber(e){Application.setState(e,"show_volume_number")}async onShowTitle(e){Application.setState(e,"show_title")}};u();var H=Ce(re(),1);u();var ii=[{id:"",value:"Default Sort"},{id:"follow",value:"Most popular"},{id:"user_follow_count",value:"Most follows"},{id:"view",value:"Most views"},{id:"rating",value:"High rating"},{id:"uploaded",value:"Last updated"},{id:"created_at",value:"Newest"}],et=[{id:"1",value:"Shonen"},{id:"2",value:"Shoujo"},{id:"3",value:"Seinen"},{id:"4",value:"Josei"},{id:"5",value:"None"}],ni=[{id:"user",value:"User"},{id:"author",value:"Author"},{id:"group",value:"Group"},{id:"comic",value:"Comic"}],oi=[{id:"3",value:"3 days"},{id:"7",value:"7 days"},{id:"30",value:"30 days"},{id:"90",value:"3 months"},{id:"180",value:"6 months"},{id:"365",value:"1 year"}],ie=[{id:"kr",value:"Manhwa"},{id:"jp",value:"Manga"},{id:"cn",value:"Manhua"},{id:"others",value:"Others"}];function In(r,e=[]){let t=e[0]?.b2key;if(!t)return r??"";let i=e[0]?.vol??"",n=r?.lastIndexOf("/");return n!==void 0&&n!==-1?r.substring(0,n+1)+`${t}#${i}`:r??""}var si=(r,e,t)=>{let{comic:i,authors:n,artists:o}=r,s=[i.title,...i.md_titles.map(w=>w.title)],c=Application.decodeHTMLEntities(i.desc??"").split("---")[0].trim(),l=[],p=Cn(i.country);p&&l.push(...Ee([{slug:i.country,name:p}],"type","Type")),l.push(...Ee(i.md_comic_md_genres.map(w=>w.md_genres),"genres","Genres")),Xe()&&i.mu_comics&&l.push(...xn(i.mu_comics.mu_comic_categories.map(w=>w.mu_categories),"tags","Tags"));let h=parseFloat(i.bayesian_rating),x=isNaN(h)?void 0:h/10,E={thumbnailUrl:In(i.cover_url,i.md_covers),synopsis:c,primaryTitle:s[0],secondaryTitles:s,contentRating:it(i.content_rating),status:Sn(i.status),artist:o.map(w=>w.name).join(","),author:n.map(w=>w.name).join(","),rating:x,tagGroups:l,shareUrl:new M(t).addPath("comic").addPath(i.slug).build()};return{mangaId:e,mangaInfo:E}};function tt(r,e,t){let i=Rn(r.chapters,t),n=i.some(s=>s.vol!==null),o=i.length;return i.map(s=>{let c=parseFloat(s.chap),l=Number(s.vol),p=s.group_name??[],f=0;return s.vol!==null&&t.showVol&&!isNaN(l)?f=l:s.vol===null&&t.showVol&&n&&(f=void 0),{chapterId:s.hid,sourceManga:e,title:t.showTitle&&s.title?`${s.title}`:"",chapNum:isNaN(c)?0:c,sortingIndex:o--,volume:f,publishDate:new Date(s.created_at),version:p.join(","),langCode:ri(s.lang)}})}function rt(r,e){if(e&&r.length>0){let t=r[0];if(t?.publishDate&&t.publishDate<=e)return{hasNewChapters:!1,parsedChapters:r.filter(i=>i.publishDate&&i.publishDate>e)}}return{hasNewChapters:!0,parsedChapters:r}}var ai=(r,e)=>({id:e.chapterId,mangaId:e.sourceManga.mangaId,pages:r.chapter.images.filter(t=>t.url).map(t=>t.url)});function Ee(r,e,t){let i=r.filter(n=>n.slug&&n.name).map(n=>({id:n.slug,title:n.name}));return[{id:e,title:t,tags:i}]}function xn(r,e,t){let i=r.filter(n=>n.slug&&n.title).map(n=>({id:n.slug,title:n.title}));return[{id:e,title:t,tags:i}]}function ui(r){return r.filter(e=>e.hid).map(e=>({imageUrl:e.cover_url,title:Application.decodeHTMLEntities(e.title),mangaId:e.hid,subtitle:Application.decodeHTMLEntities(e.last_chapter?`Chapter ${e.last_chapter}`:e.title),contentRating:it(e.content_rating)}))}function ci(r,e){return r.filter(t=>t.hid).map(t=>{let i={imageUrl:t.cover_url,title:Application.decodeHTMLEntities(t.title),mangaId:t.hid,contentRating:it(t.content_rating)};switch(e){case H.DiscoverSectionType.featured:return{...i,type:"featuredCarouselItem"};case H.DiscoverSectionType.prominentCarousel:return{...i,type:"prominentCarouselItem"};case H.DiscoverSectionType.simpleCarousel:return{...i,subtitle:Application.decodeHTMLEntities(t.last_chapter?`Chapter ${t.last_chapter}`:t.title),type:"simpleCarouselItem"};default:throw new Error(`Unknown discover section type: ${e}`)}})}function it(r){return r==="erotica"?H.ContentRating.ADULT:r==="suggestive"?H.ContentRating.MATURE:H.ContentRating.EVERYONE}function Cn(r){return ie.find(e=>e.id===r)?.value}function Sn(r){return{1:"ONGOING",2:"COMPLETED",3:"CANCELLED",4:"ON HIATUS"}[r]||"UNKNOWN"}function Rn(r,e){let t=r;if(e.hideUnreleasedChapters){let i=new Date;t=t.filter(n=>new Date(n.publish_at)<=i)}return e.chapterScoreFiltering&&(t=bn(t)),t}function bn(r){let e=new Map;return r.forEach(t=>{let i=Number(t.chap),n=t.up_count-t.down_count,o=e.get(i);(!o||n>o.score)&&e.set(i,{score:n,chapter:t})}),Array.from(e.values()).map(t=>t.chapter)}var li="https://comick.io",X="https://api.comick.fun",nt=60,ot=class extends P.PaperbackInterceptor{async interceptRequest(e){return e.headers={...e.headers??{},referer:li,"user-agent":await Application.getDefaultUserAgent()},e}async interceptResponse(e,t,i){return i}},Ie=class{globalRateLimiter=new P.BasicRateLimiter("rateLimiter",{numberOfRequests:4,bufferInterval:1,ignoreImages:!0});mainRequestInterceptor=new ot("main");async initialise(){this.globalRateLimiter.registerInterceptor(),this.mainRequestInterceptor.registerInterceptor()}async getSettingsForm(){return new _e}async getDiscoverSections(){return[{id:"most_viewed",title:"Most Viewed",type:P.DiscoverSectionType.prominentCarousel},{id:"most_followed",title:"Most Followed",type:P.DiscoverSectionType.simpleCarousel},{id:"latest_uploads",title:"Latest Uploads",type:P.DiscoverSectionType.simpleCarousel},{id:"genres",title:"Genres",type:P.DiscoverSectionType.genres}]}async getDiscoverSectionItems(e,t){switch(e.id){case"most_viewed":return this.getDiscoverSectionItemsWrapper(e,t,"view",20);case"most_followed":return this.getDiscoverSectionItemsWrapper(e,t,"follow",20);case"latest_uploads":return this.getDiscoverSectionItemsWrapper(e,t,"uploaded",20);case"genres":return this.getDiscoverSectionGenres();default:return this.getDiscoverSectionItemsWrapper(e,t,"",20)}}async getMangaDetails(e){let t={url:new M(X).addPath("comic").addPath(e).addQuery("tachiyomi","true").build(),method:"GET"},i=await this.fetchApi(t);return si(i,e,li)}async getChapters(e,t){let i=this.getChapterFilter(),n=[],o=1e5;t&&(o=nt);let s=1,c=await this.createChapterRequest(e.mangaId,s++,o),{hasNewChapters:l,parsedChapters:p}=rt(tt(c,e,i),t);if(p.forEach(f=>n.push(f)),l)for(;c.chapters.length===o;){c=await this.createChapterRequest(e.mangaId,s++,o);let{hasNewChapters:f,parsedChapters:h}=rt(tt(c,e,i),t);if(h.forEach(x=>n.push(x)),!f)break}return n}async createChapterRequest(e,t,i=1e5){let n=new M(X).addPath("comic").addPath(e).addPath("chapters").addQuery("page",t.toString()).addQuery("limit",i.toString()).addQuery("tachiyomi","true"),o=we();o[0]!="all"&&n.addQuery("lang",o.join(","));let s={url:n.build(),method:"GET"};return await this.fetchApi(s)}async getChapterDetails(e){let t={url:new M(X).addPath("chapter").addPath(e.chapterId).addQuery("tachiyomi","true").build(),method:"GET"},i=await this.fetchApi(t);return ai(i,e)}async getSearchFilters(){let e=[];e.push({type:"multiselect",options:et,id:"demographic",allowExclusion:!1,title:"Demographic",value:{},allowEmptySelection:!0,maximum:et.length}),e.push({id:"type",type:"dropdown",options:ni,value:"",title:"Search by Entity Type"}),e.push({id:"created-at",type:"dropdown",options:oi,value:"",title:"Created At"}),e.push({type:"multiselect",options:ie,id:"comic-type",allowExclusion:!1,title:"Comic Type",value:{},allowEmptySelection:!0,maximum:ie.length});let t=await this.getGenres(),i=Ee(t,"genres","Genres");for(let n of i)e.push({type:"multiselect",options:n.tags.map(o=>({id:o.id,value:o.title})),id:n.id,allowExclusion:!0,title:n.title,value:{},allowEmptySelection:!1,maximum:void 0});return e.push({type:"input",id:"minium-chapters",title:"Minimum Chapters",placeholder:'Example: "10"',value:""}),e.push({type:"input",id:"from-year",title:"From Year",placeholder:'Example: "2018"',value:""}),e.push({type:"input",id:"to-year",title:"To Year",placeholder:'Example: "2023"',value:""}),e.push({type:"input",id:"included-tags",title:"Included Tags",placeholder:'Example: "Level System, RPG"',value:""}),e.push({type:"input",id:"excluded-tags",title:"Excluded Tags",placeholder:'Example: "Greedy Protagonist"',value:""}),e}async getSortingOptions(){return ii.map(t=>({id:t.id,label:t.value}))}async getSearchResults(e,t,i){if(t?.completed)return P.EndOfPageResults;let n=t?.page??1,o=new M(X).addPath("v1.0").addPath("search").addQuery("page",n).addQuery("limit",nt).addQuery("tachiyomi","true"),s=O=>e.filters.find(N=>N.id==O)?.value,c=s("genres");if(c&&typeof c=="object"){let O=[],N=[];for(let D of Object.entries(c))switch(D[1]){case"excluded":O.push(D[0]);break;case"included":N.push(D[0]);break}o.addQuery("excludes",O),o.addQuery("genres",N)}let l=i?.id;l&&typeof l=="string"&&o.addQuery("sort",l);let p=s("created-at");p&&typeof p=="string"&&o.addQuery("time",p);let f=s("type");f&&typeof f=="string"&&o.addQuery("type",f);let h=s("demographic");h&&typeof h=="object"&&o.addQuery("demographic",Object.keys(h));let x=s("comic-type");x&&typeof x=="object"&&o.addQuery("country",Object.keys(x));let E=s("minium-chapters");E&&typeof E=="string"&&o.addQuery("minimum",E);let w=s("from-year");w&&typeof w=="string"&&o.addQuery("from",w);let B=s("to-year");B&&typeof B=="string"&&o.addQuery("to",B);let b=s("included-tags");if(b&&typeof b=="string"){let O=[];for(let N of b.split(",")){let D=N.trim().toLowerCase();D.length>0&&O.push(D.replace(/ /g,"-"))}o.addQuery("tags",O)}let Z=s("excluded-tags");if(Z&&typeof Z=="string"){let O=[];for(let N of Z.split(",")){let D=N.trim().toLowerCase();D.length>0&&O.push(D.replace(/ /g,"-"))}o.addQuery("excluded-tags",O)}o.addQuery("q",e.title.replace(/ /g,"%20"));let xe={url:o.build(),method:"GET"},st=await this.fetchApi(xe),pi=ui(st);return t=st.length===nt?{page:n+1,completed:!1}:{completed:!0},{items:pi,metadata:t}}async getGenres(){let e={url:new M(X).addPath("genre").addQuery("tachiyomi","true").build(),method:"GET"};return await this.fetchApi(e)}async getDiscoverSectionGenres(){return{items:(await this.getGenres()).map(t=>({type:"genresCarouselItem",searchQuery:{title:"",filters:[{id:"genres",value:{[t.slug]:"included"}}]},name:t.name,metadata:void 0})),metadata:void 0}}async getDiscoverSectionItemsWrapper(e,t,i,n){if(i.length==0)return{items:[],metadata:void 0};if(t?.completed)return P.EndOfPageResults;let o=t?.page??1,s={url:new M(X).addPath("v1.0").addPath("search").addQuery("sort",i).addQuery("limit",n).addQuery("page",o).addQuery("tachiyomi","true").build(),method:"GET"},c=await this.fetchApi(s),l=ci(c,e.type);return t=c.length===n?{page:o+1,completed:!1}:{completed:!0},{items:l,metadata:t}}getChapterFilter(){return{showTitle:Ye(),showVol:ze(),chapterScoreFiltering:Ke(),hideUnreleasedChapters:Je()}}async fetchApi(e,t=1,i=4){let n,o;try{[n,o]=await Application.scheduleRequest(e)}catch{throw new Error(`Failed to fetch data from ${e.url} (request error)`)}if(n.status===429&&Ze()){if(t<i){let s=2**t*(1+Math.random()/2);return console.log(`Failed to fetch data from ${e.url} (Cloudflare Rate Limit: Attempt ${t}, retrying in ${s}s)`),await Application.sleep(s),this.fetchApi(e,t+1,i)}throw new Error(`Failed to fetch data from ${e.url} (Cloudflare Rate Limit)`)}try{return JSON.parse(Application.arrayBufferToUTF8String(o))}catch{throw new Error(`Failed to fetch data from ${e.url} (Invalid response)`)}}},Bn=new Ie;return _i(An);})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
